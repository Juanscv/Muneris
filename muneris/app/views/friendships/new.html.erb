<h1>Add friends</h1>

<%= define_grid(@users_grid, hide_submit_button: true) do |g|

	g.column do |user|
		link_to image_tag(user.avatar.url, class: 'neighbor-image'), profile_path(user.id)
	end

	g.column name: 'Family Name', attribute: 'familyname', auto_reload:  true, detach_with_id: :familyname_filter

	g.column  do |user|
		if current_user.friend_with? user 
			"Already added"
		elsif current_user.invited? user
			"Pending request..."
		elsif user.invited? current_user
			"User awaits response"
		end
	end

	g.column  do |user|
		if current_user.friend_with? user
			link_to 'Remove', network_path(user), :method => "delete", data: { confirm: 'Are you sure?' }
		elsif current_user.invited? user
			link_to "Cancel", network_path(user), :method => "delete"
		elsif user.invited? current_user
			link_to "Accept", network_path(user), :method => "put"
		else
			link_to "Add", network_index_path(:user_id => user), :method => "post"
		end
	end

	g.column do |user|
		if user.invited? current_user
			link_to "Reject", network_path(user), :method => "delete"
		end
	end

end -%>

<div style= "margin-left: auto ; margin-right: auto">
	<div class="w-container">
		<div class="w-row">
			<div class="w-col w-col-3">
				<div class ="wg-detached-filter">

					<div class="row-fluid">
						<div class="span2">Family Name:</div>
						<div class="span10"><%= grid_filter @users_grid, :familyname_filter %></div>
					</div>
					<div class="row-fluid">
						<div class="span12">
							<div class="external-buttons w-container ">
								<button class="clickable btn wg-external-reset-button" data-grid-name="grid">Reset</button>
							</div>
						</div>
					</div>

				</div>
			</div>
			<div class="w-col w-col-8">
				<div class="wice-grid">

					<%= render_grid(@users_grid) %>

				</div>
			</div>
		</div>

		<div><%= link_to 'Back', :back %></div>

	</div>
</div>
